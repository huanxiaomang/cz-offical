var C=(b,u,l)=>new Promise((c,f)=>{var o=n=>{try{d(l.next(n))}catch(m){f(m)}},w=n=>{try{d(l.throw(n))}catch(m){f(m)}},d=n=>n.done?c(n.value):Promise.resolve(n.value).then(o,w);d((l=l.apply(b,u)).next())});import{d as O,f as $,r as h,c as z,u as e,Z as G,_ as M,m as E,A as L,k as s,a8 as t,G as g,a0 as y,$ as V,a1 as j,ap as A,F as U}from"./vue-bWmcvXqU.js";import{u as q,a as J,b as K,L as v,_ as P}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-D6zdEjzf.js";import{f as W,k as Q,aj as Z,u as H}from"./entry/index-C2yXXbfE-1713597257644.js";import{W as R,E as B,B as S,af as X,$ as Y,aj as ee,ak as se,al as ae}from"./antd-D-XvgdAE.js";const ie=O({__name:"LoginForm",setup(b){const u=se,l=ae,c=R.Item,f=B.Password,{t:o}=W(),{notification:w,createErrorModal:d}=H(),{prefixCls:n}=Q("login"),m=Z(),{setLoginState:x,getLoginState:D}=q(),{getFormRules:T}=J(),k=$(),_=$(!1),r=h(localStorage.getItem("account-remember-me")?JSON.parse(localStorage.getItem("account-remember-me")):{account:"",password:""}),{validForm:N}=K(k),I=z(()=>e(D)===v.LOGIN);function F(){return C(this,null,function*(){const p=yield N();if(p)try{_.value=!0;const a=yield m.login({password:p.password,email:p.account,mode:"none"});a&&(w.success({message:o("sys.login.loginSuccessTitle"),description:`${o("sys.login.loginSuccessDesc")}: ${a.username}`,duration:3}),localStorage.setItem("account-remember-me",JSON.stringify(r)))}catch(a){d({title:o("sys.api.errorTip"),content:a.message||o("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${n}`)||document.body})}finally{_.value=!1}})}return(p,a)=>(G(),M(U,null,[E(s(P,{class:"enter-x"},null,512),[[L,I.value]]),E(s(e(R),{class:"p-4 enter-x",model:r,rules:e(T),ref_key:"formRef",ref:k,onKeypress:A(F,["enter"])},{default:t(()=>[s(e(c),{name:"account",class:"enter-x"},{default:t(()=>[s(e(B),{size:"large",value:r.account,"onUpdate:value":a[0]||(a[0]=i=>r.account=i),placeholder:"请输入账号",class:"fix-auto-fill"},null,8,["value"])]),_:1}),s(e(c),{name:"password",class:"enter-x"},{default:t(()=>[s(e(f),{size:"large",visibilityToggle:"",value:r.password,"onUpdate:value":a[1]||(a[1]=i=>r.password=i),placeholder:e(o)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),s(e(c),{class:"enter-x pt-5"},{default:t(()=>[s(e(S),{type:"primary",size:"large",block:"",onClick:F,loading:_.value},{default:t(()=>[g(" 登录 ")]),_:1},8,["loading"])]),_:1}),s(e(l),{class:"enter-x",gutter:[16,16]},{default:t(()=>[s(e(u),{md:8,xs:24},{default:t(()=>[s(e(S),{block:"",disabled:"",onClick:a[2]||(a[2]=i=>e(x)(e(v).MOBILE))},{default:t(()=>[g(y(e(o)("sys.login.mobileSignInFormTitle")),1)]),_:1})]),_:1}),s(e(u),{md:8,xs:24},{default:t(()=>[s(e(S),{block:"",disabled:"",onClick:a[3]||(a[3]=i=>e(x)(e(v).QR_CODE))},{default:t(()=>[g(y(e(o)("sys.login.qrSignInFormTitle")),1)]),_:1})]),_:1}),s(e(u),{md:8,xs:24},{default:t(()=>[s(e(S),{block:"",disabled:"",onClick:a[4]||(a[4]=i=>e(x)(e(v).REGISTER))},{default:t(()=>[g(y(e(o)("sys.login.registerButton")),1)]),_:1})]),_:1})]),_:1}),s(e(X),{class:"enter-x"},{default:t(()=>[g(y(e(o)("sys.login.otherSignIn")),1)]),_:1}),V("div",{class:j(["flex justify-evenly enter-x pt-2",`${e(n)}-sign-in-way`])},[s(e(Y)),s(e(ee))],2)]),_:1},8,["model","rules"]),[[L,I.value]])],64))}});export{ie as _};
