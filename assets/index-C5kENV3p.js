var Ve=Object.defineProperty,He=Object.defineProperties;var Xe=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Ye=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var ie=(e,a,l)=>a in e?Ve(e,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[a]=l,O=(e,a)=>{for(var l in a||(a={}))Ye.call(a,l)&&ie(e,l,a[l]);if(se)for(var l of se(a))Re.call(a,l)&&ie(e,l,a[l]);return e},ue=(e,a)=>He(e,Xe(a));var oe=(e,a,l)=>new Promise((S,k)=>{var A=K=>{try{y(l.next(K))}catch(_){k(_)}},s=K=>{try{y(l.throw(K))}catch(_){k(_)}},y=K=>K.done?S(K.value):Promise.resolve(K.value).then(A,s);y((l=l.apply(e,a)).next())});import{ar as qe,d as _e,f as Ee,ah as ze,c as M,w as P,Z as m,_ as j,u,ae as Ge,ab as I,a7 as W,a8 as U,G as de,a0 as he,a1 as fe,k as v,F as q,aa as Je,aj as We,ak as Ze,B as Qe,l as ye,r as pe,J as R,h as V,o as et,m as ke,A as ge,ac as tt,i as nt}from"./vue-bWmcvXqU.js";import{bs as at,f as lt,aF as ct,_ as Q,F as rt,bt as Se,aA as st,bu as it,aH as ut,bv as ot,aS as Ke,S as dt,aw as xe}from"./entry/index-C2yXXbfE-1713597257644.js";import{bg as ht,bh as ft,bi as yt,x as pt,bj as kt,bk as gt,D as St,l as Kt,f as ee,bl as xt,o as bt,e as Z,G as Ct,aM as vt,aZ as be,aq as At,v as Lt,a3 as Ce}from"./antd-D-XvgdAE.js";import{u as _t}from"./useContextMenu-Dhg5zWUj.js";function te(e,a){return a?typeof a=="string"?` ${e}--${a}`:Array.isArray(a)?a.reduce((l,S)=>l+te(e,S),""):Object.keys(a).reduce((l,S)=>l+(a[S]?te(e,S):""),""):""}function Et(e){return(a,l)=>(a&&typeof a!="string"&&(l=a,a=""),a=a?`${e}__${a}`:e,`${a}${te(a,l)}`)}function Te(e){return[Et(`${at}-${e}`)]}const ve=Symbol(),Ae=Symbol();function Tt(e,a){if(!ft(e)||e[Ae])return e;const{values:l,required:S,default:k,type:A,validator:s}=e,y=l||s?K=>{let _=!1,L=[];if(l&&(L=[...l,k],_||(_=L.includes(K))),s&&(_||(_=s(K))),!_&&L.length>0){const h=[...new Set(L)].map(d=>JSON.stringify(d)).join(", ");qe(`Invalid prop: validation failed${a?` for prop "${a}"`:""}. Expected one of [${h}], got value ${JSON.stringify(K)}.`)}return _}:void 0;return{type:typeof A=="object"&&Object.getOwnPropertySymbols(A).includes(ve)&&A?A[ve]:A,required:!!S,default:k,validator:y,[Ae]:!0}}const Bt=e=>ht(Object.entries(e).map(([a,l])=>[a,Tt(l,a)]));var T=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(T||{});const wt=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],Ft=Bt({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:[Array,Object],default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1},treeWrapperClassName:String}),Dt={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},Nt=_e({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:a}){const l=Ee(""),[S]=Te("tree-header"),k=e,A=a,s=ze(),{t:y}=lt(),K=M(()=>["mr-1","w-full",{"ml-5":s.headerTitle||k.title}]),_=M(()=>{const{checkable:t}=k,r=[{label:y("component.tree.expandAll"),value:T.EXPAND_ALL},{label:y("component.tree.unExpandAll"),value:T.UN_EXPAND_ALL,divider:t}];return t?[{label:y("component.tree.selectAll"),value:T.SELECT_ALL},{label:y("component.tree.unSelectAll"),value:T.UN_SELECT_ALL,divider:t},...r,{label:y("component.tree.checkStrictly"),value:T.CHECK_STRICTLY},{label:y("component.tree.checkUnStrictly"),value:T.CHECK_UN_STRICTLY}]:r}),L=({key:t})=>{var r,i,o,c;switch(t){case T.SELECT_ALL:(r=k.checkAll)==null||r.call(k,!0);break;case T.UN_SELECT_ALL:(i=k.checkAll)==null||i.call(k,!1);break;case T.EXPAND_ALL:(o=k.expandAll)==null||o.call(k,!0);break;case T.UN_EXPAND_ALL:(c=k.expandAll)==null||c.call(k,!1);break;case T.CHECK_STRICTLY:A("strictly-change",!1);break;case T.CHECK_UN_STRICTLY:A("strictly-change",!0);break}};function h(t){A("search",t)}const d=rt(h,200);return P(()=>l.value,t=>{d(t)}),P(()=>k.searchText,t=>{t!==l.value&&(l.value=t)}),(t,r)=>(m(),j("div",{class:fe([u(S)(),"flex mb-1 px-2 py-1.5 items-center"])},[u(s).headerTitle?Ge(t.$slots,"headerTitle",{key:0}):I("",!0),!u(s).headerTitle&&t.title?(m(),W(u(ct),{key:1,helpMessage:t.helpMessage},{default:U(()=>[de(he(t.title),1)]),_:1},8,["helpMessage"])):I("",!0),t.search||t.toolbar?(m(),j("div",Dt,[t.search?(m(),j("div",{key:0,class:fe(K.value)},[v(u(yt),{placeholder:u(y)("common.searchText"),size:"small",allowClear:"",value:l.value,"onUpdate:value":r[0]||(r[0]=i=>l.value=i)},null,8,["placeholder","value"])],2)):I("",!0),t.toolbar?(m(),W(u(St),{key:1,onClick:r[1]||(r[1]=Qe(()=>{},["prevent"]))},{overlay:U(()=>[v(u(pt),{onClick:L},{default:U(()=>[(m(!0),j(q,null,Je(_.value,i=>(m(),j(q,{key:i.value},[v(u(kt),We(Ze({key:i.value})),{default:U(()=>[de(he(i.label),1)]),_:2},1040),i.divider?(m(),W(u(gt),{key:0})):I("",!0)],64))),128))]),_:1})]),default:U(()=>[v(Q,{icon:"ion:ellipsis-vertical"})]),_:1})):I("",!0)])):I("",!0)],2))}}),mt=({icon:e})=>e?Kt(e)?ye(Q,{icon:e,class:"mr-2"}):ye(Q):null;function Mt(e,a){function l(h){const d=[],t=h||u(e),{key:r,children:i}=u(a);if(!i||!r)return d;for(let o=0;o<t.length;o++){const c=t[o];d.push(c[r]);const p=c[i];p&&p.length&&d.push(...l(p))}return d}function S(h){const d=[],t=h||u(e),{key:r,children:i}=u(a);if(!i||!r)return d;for(let o=0;o<t.length;o++){const c=t[o];c.disabled!==!0&&c.selectable!==!1&&d.push(c[r]);const p=c[i];p&&p.length&&d.push(...S(p))}return d}function k(h,d){const t=[],r=d||u(e),{key:i,children:o}=u(a);if(!o||!i)return t;for(let c=0;c<r.length;c++){const p=r[c],E=p[o];h===p[i]?(t.push(p[i]),E&&E.length&&t.push(...l(E))):E&&E.length&&t.push(...k(h,E))}return t}function A(h,d,t){if(!h)return;const r=t||u(e),{key:i,children:o}=u(a);if(!(!o||!i))for(let c=0;c<r.length;c++){const p=r[c],E=p[o];if(p[i]===h){r[c]=O(O({},r[c]),d);break}else E&&E.length&&A(h,d,p[o])}}function s(h=1,d,t=1){if(!h)return[];const r=[],i=d||u(e)||[];for(let o=0;o<i.length;o++){const c=i[o],{key:p,children:E}=u(a),z=p?c[p]:"",$=E?c[E]:[];r.push(z),$&&$.length&&t<h&&(t+=1,r.push(...s(h,$,t)))}return r}function y({parentKey:h=null,node:d,push:t="push"}){const r=ee(u(e));if(!h){r[t](d),e.value=r;return}const{key:i,children:o}=u(a);!o||!i||(Se(r,c=>{if(c[i]===h)return c[o]=c[o]||[],c[o][t](d),!0}),e.value=r)}function K({parentKey:h=null,list:d,push:t="push"}){const r=ee(u(e));if(!(!d||d.length<1))if(h){const{key:i,children:o}=u(a);if(!o||!i)return;Se(r,c=>{if(c[i]===h){c[o]=c[o]||[];for(let p=0;p<d.length;p++)c[o][t](d[p]);return e.value=r,!0}})}else{for(let i=0;i<d.length;i++)r[t](d[i]);e.value=r;return}}function _(h,d){if(!h)return;const t=d||u(e),{key:r,children:i}=u(a);if(!(!i||!r))for(let o=0;o<t.length;o++){const c=t[o],p=c[i];if(c[r]===h){t.splice(o,1);break}else p&&p.length&&_(h,c[i])}}function L(h,d,t){if(!h&&h!==0)return null;const r=d||u(e),{key:i,children:o}=u(a);return i?(r.forEach(c=>{if(t!=null&&t.key||(t==null?void 0:t.key)===0)return t;if(c[i]===h){t=c;return}c[o]&&c[o].length&&(t=L(h,c[o],t))}),t||null):null}return{deleteNodeByKey:_,insertNodeByKey:y,insertNodesByKey:K,filterByLevel:s,updateNodeByKey:A,getAllKeys:l,getChildrenKeys:k,getEnabledKeys:S,getSelectedNode:L}}function Le(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!nt(e)}const Ut=_e({name:"BasicTree",inheritAttrs:!1,props:Ft,emits:wt,setup(e,{attrs:a,slots:l,emit:S,expose:k}){const[A]=Te("tree"),s=pe({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),y=pe({startSearch:!1,searchText:"",searchData:[]}),K=Ee([]),[_]=_t(),L=M(()=>{const{fieldNames:n}=e;return O({children:"children",title:"title",key:"key"},n)}),h=M(()=>{let n=ue(O(O({blockNode:!0},a),e),{expandedKeys:s.expandedKeys,selectedKeys:s.selectedKeys,checkedKeys:s.checkedKeys,checkStrictly:s.checkStrictly,fieldNames:u(L),"onUpdate:expandedKeys":f=>{s.expandedKeys=f,S("update:expandedKeys",f)},"onUpdate:selectedKeys":f=>{s.selectedKeys=f,S("update:selectedKeys",f)},onCheck:(f,x)=>{let g=R(s.checkedKeys);if(st(g)&&y.startSearch){const C=x.node.eventKey;g=xt(g,z(C)),x.checked&&g.push(C),s.checkedKeys=g}else s.checkedKeys=f;const b=R(s.checkedKeys);S("update:value",b),S("check",b,x)},onRightClick:Fe});return bt(n,"treeData","class")}),d=M(()=>y.startSearch?y.searchData:u(K)),t=M(()=>!d.value||d.value.length===0),{deleteNodeByKey:r,insertNodeByKey:i,insertNodesByKey:o,filterByLevel:c,updateNodeByKey:p,getAllKeys:E,getChildrenKeys:z,getEnabledKeys:$,getSelectedNode:Be}=Mt(K,L);function we(n,f){return!f&&e.renderIcon&&Z(e.renderIcon)?e.renderIcon(n):f}function Fe(x){return oe(this,arguments,function*({event:n,node:f}){var D;const{rightMenuList:g=[],beforeRightClick:b}=e;let C={event:n,items:[]};if(b&&Z(b)){let B=yield b(f,n);Array.isArray(B)?C.items=B:Object.assign(C,B)}else C.items=g;(D=C.items)!=null&&D.length&&(C.items=C.items.filter(B=>!B.hidden),_(C))})}function De(){return u(K)}function H(n){s.expandedKeys=n}function Ne(){return s.expandedKeys}function ne(n){s.selectedKeys=n}function me(){return s.selectedKeys}function ae(n){s.checkedKeys=n}function Me(){return s.checkedKeys}function le(n){s.checkedKeys=n?$():[]}function G(n){s.expandedKeys=n?E():[]}function Oe(n){s.checkStrictly=n}P(()=>e.searchValue,n=>{n!==y.searchText&&(y.searchText=n)},{immediate:!0}),P(()=>e.treeData,n=>{n&&J(y.searchText)});function J(n){if(n!==y.searchText&&(y.searchText=n),S("update:searchValue",n),!n){y.startSearch=!1;return}const{filterFn:f,checkable:x,expandOnSearch:g,checkOnSearch:b,selectedOnSearch:C}=u(e);y.startSearch=!0;const{title:D,key:B}=u(L),F=[];if(y.searchData=it(u(K),w=>{var X,Y;const N=f?f(n,w,u(L)):(Y=(X=w[D])==null?void 0:X.includes(n))!=null?Y:!1;return N&&F.push(w[B]),N},u(L)),g){const w=ut(y.searchData).map(N=>N[B]);w&&w.length&&H(w)}b&&x&&F.length&&ae(F),C&&F.length&&ne(F)}function Ie(n,f){if(!(!e.clickRowToExpand||!f||f.length===0))if(!s.expandedKeys.includes(n))H([...s.expandedKeys,n]);else{const x=[...s.expandedKeys],g=x.findIndex(b=>b===n);g!==-1&&x.splice(g,1),H(x)}}V(()=>{K.value=e.treeData}),et(()=>{const n=parseInt(e.defaultExpandLevel);n>0?s.expandedKeys=c(n):e.defaultExpandAll&&G(!0)}),V(()=>{s.expandedKeys=e.expandedKeys}),V(()=>{s.selectedKeys=e.selectedKeys}),V(()=>{s.checkedKeys=e.checkedKeys}),P(()=>e.value,()=>{s.checkedKeys=R(e.value||[])},{immediate:!0}),P(()=>s.checkedKeys,()=>{const n=R(s.checkedKeys);S("update:value",n),S("change",n)}),V(()=>{s.checkStrictly=e.checkStrictly});const Pe={getTreeData:De,setExpandedKeys:H,getExpandedKeys:Ne,setSelectedKeys:ne,getSelectedKeys:me,setCheckedKeys:ae,getCheckedKeys:Me,insertNodeByKey:i,insertNodesByKey:o,deleteNodeByKey:r,updateNodeByKey:p,getSelectedNode:Be,checkAll:le,expandAll:G,filterByLevel:n=>{s.expandedKeys=c(n)},setSearchValue:n=>{J(n)},getSearchValue:()=>y.searchText};function $e(n){const{actionList:f}=e;if(!(!f||f.length===0))return f.map((x,g)=>{var C;let b=!0;return Z(x.show)?b=(C=x.show)==null?void 0:C.call(x,n):Ce(x.show)&&(b=x.show),b?v("span",{key:g,class:A("action")},[x.render(n)]):null})}const je=M(()=>{const n=ee(d.value);return ot(n,(f,x)=>{var re;const g=y.searchText,{highlight:b}=u(e),{title:C,key:D,children:B}=u(L),F=we(f,f.icon),w=At(f,C),N=g?w.indexOf(g):-1,X=y.startSearch&&!Lt(g)&&b&&N!==-1,Y=`color: ${Ce(b)?"#f50":b}`,Ue=X?v("span",{class:(re=u(h))!=null&&re.blockNode?`${A("content")}`:""},[v("span",null,[w.substr(0,N)]),v("span",{style:Y},[g]),v("span",null,[w.substr(N+g.length)])]):w,ce=F?v(mt,{icon:F},null):l.icon?v("span",{class:"mr-2"},[xe(l,"icon")]):null;return f[C]=v("span",{class:`${A("title")}`,onClick:Ie.bind(null,f[D],f[B])},[l!=null&&l.title?v(q,null,[ce,xe(l,"title",f)]):v(q,null,[ce,Ue,v("span",{class:A("actions")},[$e(f)])])]),f}),n});return k(Pe),()=>{let n,f;const{title:x,helpMessage:g,toolbar:b,search:C,checkable:D}=e,B=x||b||C||l.headerTitle,F={height:"calc(100% - 38px)"};return v("div",{class:[A(),"h-full",a.class]},[B&&v(Nt,{checkable:D,checkAll:le,expandAll:G,title:x,search:C,toolbar:b,helpMessage:g,onStrictlyChange:Oe,onSearch:J,searchText:y.searchText},Le(n=Ke(l))?n:{default:()=>[n]}),v(Ct,{wrapperClassName:u(e.treeWrapperClassName),spinning:u(e.loading),tip:"加载中..."},{default:()=>[ke(v(dt,{style:F},{default:()=>[v(vt,tt(u(h),{showIcon:!1,treeData:je.value}),Le(f=Ke(l,["title"]))?f:{default:()=>[f]})]}),[[ge,!u(t)]]),ke(v(be,{image:be.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[ge,u(t)]])]})])}}});export{Ut as _};
