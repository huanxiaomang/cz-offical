import{bn as N,bo as R,bp as z,aP as W,ax as T}from"./entry/index-C2yXXbfE-1713597257644.js";import{f as p,u as s,s as L,g as P,j as U,d as F,b as V,a9 as j,Z as D,a7 as G,a8 as b,k as g,G as h}from"./vue-bWmcvXqU.js";import{P as H}from"./index-DmvVZzf-.js";import"./antd-D-XvgdAE.js";import"./useContentViewHeight-ByP0kkZI.js";import"./useWindowSizeFn-rAoW7C_Y.js";import"./onMountedOrActivated-C5rGMWQz.js";const A="watermark-dom",x=p(null),y=new Map;function _(n){return Array.from(y.values()).find(t=>t.targetElement===n)}function E(n,t){const r=document.createElement("canvas"),u=300,l=240;Object.assign(r,{width:u,height:l});const o=r.getContext("2d");if(o){const i=(t==null?void 0:t.fontFamily)||"Vedana",d=(t==null?void 0:t.fontSize)||15,c=(t==null?void 0:t.fontColor)||"rgba(0, 0, 0, 0.15)",f=(t==null?void 0:t.textAlign)||"left",e=(t==null?void 0:t.textBaseline)||"middle",a=(t==null?void 0:t.rotate)||20;o.rotate(-a*Math.PI/180),o.font=`${d}px ${i}`,o.fillStyle=c,o.textAlign=f,o.textBaseline=e,o.fillText(n,u/20,l)}return r.toDataURL("image/png")}const S=(n,t,r)=>{n.className="__"+A,n.style.pointerEvents="none",n.style.display="block",n.style.visibility="visible",n.style.top="0px",n.style.left="0px",n.style.position="absolute",n.style.zIndex="100000",n.style.height="100%",n.style.width="100%",n.style.background=`url(${E(s(x)||t,r)}) left top repeat`},Z=()=>new MutationObserver(t=>{var r;for(const u of t){for(const l of Array.from(u.removedNodes)){const o=_(l);if(!o)return;const{targetElement:i,parentElement:d}=o;d!=null&&d.contains(i)||(r=o==null?void 0:o.parentElement)==null||r.appendChild(l)}if(u.attributeName==="style"&&u.target){const l=u.target,o=_(l);if(o){const{waterMarkOptions:i={}}=o;S(l,l==null?void 0:l["data-watermark-text"],i)}}}});function v(n=p(document.body),t={}){const r=Symbol(A);if(s(n)&&y.has(r)){const{setWatermark:e,clear:a}=y.get(r);return{setWatermark:e,clear:a,clearAll:$}}const l=z(function(){const e=s(n);if(!e)return;const{clientHeight:a,clientWidth:m}=e;d({height:a,width:m})}),o=L(),i=()=>{var m,C;const e=s(o);o.value=void 0;const a=s(n);y.has(r)&&((C=(m=y.get(r))==null?void 0:m.obInstance)==null||C.disconnect()),y.delete(r),a&&(e&&a.removeChild(e),N(a,l))};function d(e={}){const a=s(o);a&&(W(e.width)&&(a.style.width=`${e.width}px`),W(e.height)&&(a.style.height=`${e.height}px`),W(e.str)&&(a.style.background=`url(${E(e.str,t)}) left top repeat`))}const c=e=>{var k,I;if(s(o)&&y.has(r)){x.value=e,d({str:e});return}const a=document.createElement("div");a["data-watermark-text"]=e,x.value=e,o.value=a,S(a,e,t);const m=s(n);if(!m)return;const{clientHeight:C,clientWidth:B}=m;d({str:e,width:B,height:C}),m.appendChild(a),y.set(r,{setWatermark:f,clear:i,parentElement:m,targetElement:a,obInstance:Z(),waterMarkOptions:t}),(I=(k=y.get(r))==null?void 0:k.obInstance)==null||I.observe(m,{childList:!0,subtree:!0,attributes:!0})};function f(e){c(e),R(document.documentElement,l),P()&&U(()=>{i()})}return{setWatermark:f,clear:i,clearAll:$}}function $(){Array.from(y.values()).forEach(n=>{var t;(t=n==null?void 0:n.obInstance)==null||t.disconnect(),n.clear()})}const M=F({__name:"index",setup(n){const t=p(document.body),{setWatermark:r,clear:u,clearAll:l}=v(),{setWatermark:o}=v(),{setWatermark:i}=v(t,{fontColor:"red",fontSize:12,rotate:30});return V(()=>{l()}),(d,c)=>{const f=j("a-button");return D(),G(s(H),{title:"水印示例"},{default:b(()=>[g(s(T),{class:"w-full h-32 bg-white rounded-md",title:"Global WaterMark"},{default:b(()=>[g(f,{type:"primary",class:"mr-2",onClick:c[0]||(c[0]=e=>s(r)("WaterMark Info1"))},{default:b(()=>[h(" Create Watermark1 ")]),_:1}),g(f,{type:"primary",class:"mr-2",onClick:c[1]||(c[1]=e=>s(o)("WaterMark Info2"))},{default:b(()=>[h(" Create Watermark2 ")]),_:1}),g(f,{type:"primary",class:"mr-2",onClick:c[2]||(c[2]=e=>s(i)("Custome Style WaterMark"))},{default:b(()=>[h(" Create custom style Watermark ")]),_:1}),g(f,{color:"error",class:"mr-2",onClick:s(u)},{default:b(()=>[h(" Clear Watermark1 ")]),_:1},8,["onClick"]),g(f,{color:"error",class:"mr-2",onClick:s(l)},{default:b(()=>[h(" ClearAll ")]),_:1},8,["onClick"]),g(f,{color:"warning",class:"mr-2",onClick:c[3]||(c[3]=e=>s(r)("WaterMark Info New"))},{default:b(()=>[h(" Update Watermark1 ")]),_:1})]),_:1})]),_:1})}}});export{M as default};
